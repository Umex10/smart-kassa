# Zynqly - smart-kassa

<p align=center>
 <a href="https://smart-kassa.vercel.app/"><img src="./frontend/public/Logo.svg" width=300> </a>
</p>

## What is it about?

The goal of this project is to create a modern register system initially designed for taxi companies.
In the future, the system will be expanded and adapted for other business sectors.

### Key Features

- **Registering Rides**
- **Map with navigation to place of goal**
- **All rides documented and saved in a database**
  - **Sorting functionality**
  - **Beatiful Animation**
- **Dynamically generated invoice and saved it in a storage**
- **All invoices documented**
  - **PDF Viewer in App**
  - **QR Code to scan to access Invoice via a URL**
  - **Downloadable**
- **Dashboard with Analytics**
- **Safe Authentication System**
- **Mobile App for both iOS and Android**

### Availabe at

<p align=center>
<img src="https://img.shields.io/badge/Android-3DDC84?logo=android&logoColor=white" alt="android" height=40>
<img src="https://img.shields.io/badge/iOS-000000?logo=apple&logoColor=white" alt="ios" height=40>
<img src="https://img.shields.io/badge/üåê-Web%20App-4A90E2" alt="web" height=40>
<p>

## Tech Stack

### Application

- Git (Version Control System)
- GitHub (Cloud-Based Hosting Platform)

#### Overview

<p align="left">
  <img src="https://img.shields.io/badge/git-%23F05033.svg?style=plastic&logo=git&logoColor=white" alt="Git">
  <img src="https://img.shields.io/badge/github-%23121011.svg?style=plastic&logo=github&logoColor=white" alt="GitHub">
</p>

### Frontend

#### Web App 

deployed on **Vercel**

- React (UI Libary)
- TypeScript (Programming Language)
- TailwindCSS (CSS Framework)
- Redux (State Managment)
- Shadcn/ui (Component Libary)
- Framer Motion (Animation Libary)
- Vitetest (Testing Framework)
- Vite (Build Tool)
- Leaflet (Map Libary)

#### Mobile App

- Capacitor (Cross-Platform-Framework)

#### Packet Manager

- npm (Node Packet Manager)

#### Overview

<p align=center>
  <img src="https://img.shields.io/badge/NPM-%23CB3837.svg?style=plastic&logo=npm&logoColor=white" alt="NPM">
  <img src="https://img.shields.io/badge/javascript-%23323330.svg?style=plastic&logo=javascript&logoColor=%23F7DF1E" alt="JavaScript">
  <img src="https://img.shields.io/badge/typescript-%23007ACC.svg?style=plastic&logo=typescript&logoColor=white" alt="TypeScript">
  <img src="https://img.shields.io/badge/react-%2320232a.svg?style=plastic&logo=react&logoColor=%2361DAFB" alt="React">
  <img src="https://img.shields.io/badge/React_Router-CA4245?style=plastic&logo=react-router&logoColor=white" alt="React Router">
  <img src="https://img.shields.io/badge/redux-%23593d88.svg?style=plastic&logo=redux&logoColor=white" alt="Redux">
  <img src="https://img.shields.io/badge/vite-%23646CFF.svg?style=plastic&logo=vite&logoColor=white" alt="Vite">
  <img src="https://img.shields.io/badge/Vitest-6E9F18?style=plastic&logo=vitest&logoColor=white" alt="Vitest">
  <img src="https://img.shields.io/badge/tailwindcss-%2338B2AC.svg?style=plastic&logo=tailwind-css&logoColor=white" alt="TailwindCSS">
  <img src="https://img.shields.io/badge/shadcn/ui-000000?style=plastic&logo=shadcnui&logoColor=white" alt="shadcn/ui">
  <img src="https://img.shields.io/badge/Framer-black?style=plastic&logo=framer&logoColor=blue" alt="Framer Motion">
  <img src="https://img.shields.io/badge/Leaflet-199900?style=plastic&logo=Leaflet&logoColor=white" alt="Leaflet">
  <img src="https://img.shields.io/badge/Capacitor-119EFF?style=plastic&logo=Capacitor&logoColor=white" alt="Capacitor">
  <img src="https://img.shields.io/badge/axios-671ddf?style=plastic&logo=axios&logoColor=white" alt="Axios">
</p>


---

### Backend

deployed on **Railway**

- Node.js (Runtime Environment)
- Express.js (Backend Framework)
- JavaScript (Programming Language)
- PostgreSQL (Database Management System)
- JWT (Authentication Method)
- Argon2 (Password Hashing)
- AWS SDK (Cloud Storage)
- Puppeteer (PDF Generation)
- Helmet (Security Middleware)
- Postman (API Testing)

#### Packet Manager

- npm (Node Packet Manager)

#### Overview

<p align="center">
  <img src="https://img.shields.io/badge/NPM-%23CB3837.svg?style=plastic&logo=npm&logoColor=white" alt="NPM">
  <img src="https://img.shields.io/badge/javascript-%23323330.svg?style=plastic&logo=javascript&logoColor=%23F7DF1E" alt="JavaScript">
  <img src="https://img.shields.io/badge/node.js-6DA55F?style=plastic&logo=node.js&logoColor=white" alt="Node.js">
  <img src="https://img.shields.io/badge/express.js-%23404d59.svg?style=plastic&logo=express&logoColor=%2361DAFB" alt="Express.js">
  <img src="https://img.shields.io/badge/postgres-%23316192.svg?style=plastic&logo=postgresql&logoColor=white" alt="PostgreSQL">
  <img src="https://img.shields.io/badge/JWT-black?style=plastic&logo=JSON%20web%20tokens" alt="JWT">
  <img src="https://img.shields.io/badge/AWS-%23FF9900.svg?style=plastic&logo=amazon-aws&logoColor=white" alt="AWS">
  <img src="https://img.shields.io/badge/Railway-131415?style=plastic&logo=railway&logoColor=white" alt="Railway">
  <img src="https://img.shields.io/badge/Puppeteer-40B5A4?style=plastic&logo=Puppeteer&logoColor=white" alt="Puppeteer">
  <img src="https://img.shields.io/badge/Postman-FF6C37?style=plastic&logo=postman&logoColor=white" alt="Postman">
</p>

---

### Design

- Figma (Design Tool)
- Shadcn/ui (Component Library)

#### Overview

<p align="left">
  <img src="https://img.shields.io/badge/figma-%23F24E1E.svg?style=plastic&logo=figma&logoColor=white" alt="Figma">
  <img src="https://img.shields.io/badge/shadcn/ui-000000?style=plastic&logo=shadcnui&logoColor=white" alt="shadcn/ui">
</p>

---

### Documentation

- Markdown (Markup Language)
- Mermaid Chart (Diagramming Tool)
- Figma (Design Platform)
- Microsoft Word (Word Processing Program)

#### Overview

<p align="center">
  <img src="https://img.shields.io/badge/markdown-%23000000.svg?style=plastic&logo=markdown&logoColor=white" alt="Markdown">
  <img src="https://img.shields.io/badge/Mermaid-FF3670?style=plastic&logo=mermaid&logoColor=white" alt="Mermaid">
  <img src="https://img.shields.io/badge/figma-%23F24E1E.svg?style=plastic&logo=figma&logoColor=white" alt="Figma">
  <img src="https://img.shields.io/badge/Microsoft_Word-2B579A?style=plastic&logo=microsoft-word&logoColor=white" alt="Microsoft Word">
</p>

## Architecture

<p align="center">
<img src="./docs/pictures/Zynqly-Architecture.png" >
</p>

[Live Project Architecture (in Figma)](https://www.figma.com/design/BPqmonzixS6mlzLSKTUJoK/Zynqly---Smart-Kassa-Project?node-id=0-1&t=Ozc1u6jbwHKQTLK8-1)

## Getting Started

### Requirements

#### General (Web & Mobile)

- **Node.js** (>= 18.18)
- **npm** (Node Package Manager)
- **Git** (Version Control)
- A code editor (e.g., Visual Studio Code)

#### Web Application

No additional requirements beyond the general setup.

#### Mobile - Android

- **Android Studio** (latest version)
- **JDK** (Java Development Kit 17 or higher)
- **Android SDK** (API Level 23 or higher)
- Android device or emulator

#### Mobile - iOS

- **macOS** (required for iOS development)
- **Xcode** (14.0 or higher)
- **CocoaPods** (iOS dependency manager)
- iOS device or simulator
- Apple Developer Account (for physical device deployment)

### Installation

#### 1. Clone the Repository

```bash
git clone https://github.com/zynqly-smartkassa/smart-kassa.git
cd smart-kassa
```

#### 2. Install Frontend Dependencies

```bash
cd frontend
npm install
```

#### 3. Install Backend Dependencies

```bash
cd ../backend
npm install
```

#### 4. Environment Configuration

**Frontend** - Create a `.env.local` file in the `frontend` directory:

```env
VITE_API_URL="http://localhost:3000"
VITE_TOKEN="your-mapbox-token"
NODE_ENV="development"
MOBILE_REFRESH="false"  # Set to "true" for mobile live reload
LOCAL_URL="http://192.168.x.x:5173"  # Your local IP for mobile development
```

**Backend** - Create a `.env` file in the `backend` directory:

```env
DATABASE_URL="your-postgresql-connection-string"
JWT_SECRET="your-jwt-secret"
AWS_ACCESS_KEY_ID="your-aws-key"
AWS_SECRET_ACCESS_KEY="your-aws-secret"
```

### Running the Application

#### Web Application

**Start Backend:**
```bash
cd backend
npm run dev
```

> Note: Some features use Services from Railway, so you need to set up railway (instruction in the deployment section) for all features to work correctly

**Start Frontend:**
```bash
cd frontend
npm run dev
```

Visit `http://localhost:5173` in your browser.

#### Mobile - Android

```bash
cd frontend
npm run android
```

This will build the app, sync Capacitor, and launch Android Studio.

#### Mobile - iOS

```bash
cd frontend
npm run ios
```

This will build the app, sync Capacitor, and launch Xcode.

### Mobile Live Reload

For live reload during mobile development:

1. Set `MOBILE_REFRESH="true"` in `.env.local`
2. Update `LOCAL_URL` with your local IP address
3. Start the dev server: `npm run dev`
4. Run the mobile app: `npm run android` or `npm run ios`

---

## Deployment

### Backend Deployment on Railway

<img src="https://img.shields.io/badge/Railway-0B0D0E?logo=railway&logoColor=white" height=40 alt="Railway">

#### 1. Create Railway Account

1. Go to [Railway.app](https://railway.app/)
2. Sign up with GitHub
3. Create a new project

#### 2. Add PostgreSQL Database

1. In your Railway project, click **"New"** ‚Üí **"Database"** ‚Üí **"Add PostgreSQL"**
2. Railway will automatically create a PostgreSQL instance
3. Copy the `DATABASE_URL` from the PostgreSQL service variables

#### 3. Create Railway Bucket (S3-Compatible Storage)

1. In your Railway project, click **"New"** ‚Üí **"Bucket"**
2. Railway will create an S3-compatible storage bucket
3. Note the following bucket credentials:
   - `BUCKET_NAME` (e.g., `preserved-drawer-7jcmb0bb`)
   - `BUCKET_ACCESS_KEY_ID`
   - `BUCKET_SECRET_ACCESS_KEY`
   - `BUCKET_ENDPOINT` (usually `https://storage.railway.app`)

#### 4. Install AWS CLI

The Railway bucket uses S3-compatible API, so you need AWS CLI to configure CORS:

**Windows:**
```bash
# Download and install from: https://aws.amazon.com/cli/
# Or use winget:
winget install Amazon.AWSCLI
```

**macOS:**
```bash
brew install awscli
```

**Linux:**
```bash
curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
unzip awscliv2.zip
sudo ./aws/install
```

#### 5. Configure CORS for Railway Bucket

**Create `CORS.json` file in the backend directory:**

```json
{
  "CORSRules": [
    {
      "AllowedHeaders": ["*"],
      "AllowedMethods": ["GET", "HEAD", "POST", "PUT"],
      "AllowedOrigins": [
        "http://localhost",
        "https://localhost",
        "http://localhost:5173",
        "https://smart-kassa.vercel.app",
        "capacitor://localhost"
      ],
      "ExposeHeaders": ["Content-Disposition"],
      "MaxAgeSeconds": 3000
    }
  ]
}
```

**Apply CORS configuration:**

```bash
cd backend

# Configure AWS CLI with Railway bucket credentials
aws configure set aws_access_key_id YOUR_BUCKET_ACCESS_KEY_ID
aws configure set aws_secret_access_key YOUR_BUCKET_SECRET_ACCESS_KEY
aws configure set region us-east-1

# Apply CORS to Railway bucket
aws s3api put-bucket-cors \
  --bucket YOUR_BUCKET_NAME \
  --endpoint-url https://storage.railway.app \
  --cors-configuration file://CORS.json
```

**Example:**
```bash
aws s3api put-bucket-cors \
  --bucket preserved-drawer-7jcmb0bb \
  --endpoint-url https://storage.railway.app \
  --cors-configuration file://CORS.json
```

#### 6. Configure Backend CORS (app.js)

Make sure your `backend/app.js` includes all necessary origins:

```javascript
app.use(
  cors({
    origin: [
      "https://smart-kassa.vercel.app",
      "http://localhost",
      "https://localhost",
      "http://localhost:5173",
      "capacitor://localhost",
      process.env.DEBUG_URL, // Optional debug URL
    ],
    credentials: true,
  })
);
```

#### 7. Set Environment Variables in Railway

In your Railway backend service, add the following environment variables:

```env
# Database
DATABASE_URL=postgresql://...  # Auto-generated by Railway

# JWT
JWT_SECRET=your-secret-key-here

# AWS S3 (Railway Bucket)
AWS_ACCESS_KEY_ID=your-bucket-access-key
AWS_SECRET_ACCESS_KEY=your-bucket-secret-key
AWS_REGION=us-east-1
AWS_ENDPOINT=https://storage.railway.app
BUCKET_NAME=your-bucket-name

# Optional
DEBUG_URL=https://your-debug-url.com
PORT=3000
```

#### 8. Deploy Backend

1. Connect your GitHub repository to Railway
2. Select the `backend` folder as the root directory
3. Railway will automatically detect Node.js and deploy
4. Your backend will be available at: `https://your-project.up.railway.app`

#### 9. Update Frontend Environment Variables

Update your frontend `.env.local` to point to the Railway backend:

```env
VITE_API_URL="https://your-backend.up.railway.app"
```

### Frontend Deployment on Vercel

<img src="https://img.shields.io/badge/Vercel-000000?logo=vercel&logoColor=white" height=40 alt="Vercel"><br>

1. Go to [Vercel.com](https://vercel.com/)
2. Import your GitHub repository
3. Set the root directory to `frontend`
4. Add environment variables:
   ```env
   VITE_API_URL=https://your-backend.up.railway.app
   VITE_TOKEN=your-mapbox-token
   ```
5. Deploy

Your app will be available at: `https://smart-kassa.vercel.app`

## Project Structure

```
smart-kassa/
‚îú‚îÄ‚îÄ backend/                    # Backend API (Node.js + Express)
‚îÇ   ‚îú‚îÄ‚îÄ middleware/            # Express middleware (auth, validation)
‚îÇ   ‚îú‚îÄ‚îÄ routes/                # API route handlers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login.js          # User login
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ register.js       # User registration
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ verify.js         # Token verification
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ refresh.js        # Token refresh
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logout.js         # User logout
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deleteAccount.js  # Account deletion
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ updateProfile.js  # Profile updates
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fahrten.js        # Ride management
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ride.js           # Single ride operations
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ all-rides.js      # All rides retrieval
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ invoice.js        # Invoice generation
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ list-blobs.js     # File storage listing
‚îÇ   ‚îú‚îÄ‚îÄ services/              # Business logic services
‚îÇ   ‚îú‚îÄ‚îÄ utils/                 # Utility functions (JWT, etc.)
‚îÇ   ‚îú‚îÄ‚îÄ resources/             # Static resources
‚îÇ   ‚îú‚îÄ‚îÄ app.js                 # Express app configuration
‚îÇ   ‚îú‚îÄ‚îÄ db.js                  # Database connection
‚îÇ   ‚îú‚îÄ‚îÄ CORS.json              # CORS configuration
‚îÇ   ‚îî‚îÄ‚îÄ package.json           # Backend dependencies
‚îÇ
‚îú‚îÄ‚îÄ frontend/                   # Frontend (React + TypeScript)
‚îÇ   ‚îú‚îÄ‚îÄ android/               # Android native files (Capacitor)
‚îÇ   ‚îú‚îÄ‚îÄ ios/                   # iOS native files (Capacitor)
‚îÇ   ‚îú‚îÄ‚îÄ public/                # Static assets
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/       # Reusable UI components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/            # Page components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout/           # Layout components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/            # Custom React hooks
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lib/              # Third-party library configs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils/            # Utility functions
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types/            # TypeScript type definitions
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ content/          # Static content
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.tsx           # Main App component
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.tsx          # Entry point
‚îÇ   ‚îú‚îÄ‚îÄ redux/                 # Redux state management
‚îÇ   ‚îú‚îÄ‚îÄ constants/             # Application constants
‚îÇ   ‚îú‚îÄ‚îÄ capacitor.config.ts    # Capacitor configuration
‚îÇ   ‚îú‚îÄ‚îÄ vite.config.ts         # Vite build configuration
‚îÇ   ‚îî‚îÄ‚îÄ package.json           # Frontend dependencies
‚îÇ
‚îú‚îÄ‚îÄ docs/                       # Documentation
‚îÇ   ‚îú‚îÄ‚îÄ diagramms/             # Architecture diagrams
‚îÇ   ‚îî‚îÄ‚îÄ pictures/              # Screenshots and images
‚îÇ
‚îú‚îÄ‚îÄ .github/                    # GitHub workflows and actions
‚îú‚îÄ‚îÄ AUTH.md                     # Authentication documentation
‚îú‚îÄ‚îÄ CONTRIBUTING.md             # Contribution guidelines
‚îú‚îÄ‚îÄ DEVELOPMENT.md              # Development setup and tools
‚îî‚îÄ‚îÄ README.md                   # This file
```

---

## Authentication System

The app uses a **JWT-based authentication system** with:

- **Access Token** (15 min) - Stored in local storage/preferences
- **Refresh Token** (30 days) - Stored in httpOnly cookies
- **Multi-device support** - Separate sessions per device
- **GDPR compliant** - Soft delete with data anonymization

### Key Features

- Session management per device (device_id)
- Automatic token refresh
- Password hashing with Argon2
- Protected routes with JWT verification

### Flow Overview

1. **Register/Login** ‚Üí Receive access & refresh tokens
2. **API Requests** ‚Üí Send access token in Authorization header
3. **Token Expired** ‚Üí Auto-refresh with refresh token
4. **Refresh Expired** ‚Üí Redirect to login

For detailed authentication flow, database interactions, and diagrams, see **[AUTH.md](./AUTH.md)**

---

## API Documentation

Base URL: `https://your-backend.up.railway.app`

### Authentication Endpoints

#### POST `/register`
Register a new user account

**Request Body:**
```json
{
  "email": "user@example.com",
  "password": "securePassword123",
  "firstName": "John",
  "lastName": "Doe",
  "device_id": "unique-device-id",
  "user_agent": "Mozilla/5.0...",
  "device_name": "iPhone 13"
}
```

**Response:** `200 OK`
```json
{
  "message": "User registered successfully",
  "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": "123",
    "email": "user@example.com",
    "name": "John Doe"
  }
}
```

---

#### POST `/login`
Authenticate user and get tokens

**Request Body:**
```json
{
  "email": "user@example.com",
  "password": "securePassword123",
  "device_id": "unique-device-id",
  "user_agent": "Mozilla/5.0...",
  "device_name": "iPhone 13"
}
```

**Response:** `200 OK`
```json
{
  "message": "Login successful",
  "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": "123",
    "email": "user@example.com",
    "name": "John Doe"
  }
}
```

**Errors:**
- `400` - Missing required fields
- `401` - Invalid password
- `404` - User not found

---

#### POST `/verify`
Verify access token validity

**Headers:**
```
Authorization: Bearer <access_token>
```

**Response:** `200 OK`
```json
{
  "valid": true,
  "user": {
    "id": "123",
    "email": "user@example.com",
    "name": "John Doe"
  }
}
```

---

#### POST `/refresh`
Refresh expired access token

**Cookies:**
```
refreshToken=<refresh_token>
```

**Response:** `200 OK`
```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

**Errors:**
- `401` - Invalid or expired refresh token
- `403` - Session revoked

---

#### POST `/logout`
Log out user and revoke session

**Headers:**
```
Authorization: Bearer <access_token>
```

**Request Body:**
```json
{
  "device_id": "unique-device-id"
}
```

**Response:** `200 OK`
```json
{
  "message": "Logout successful"
}
```

---

### User Management Endpoints

#### DELETE `/account`
Delete user account (soft delete)

**Headers:**
```
Authorization: Bearer <access_token>
```

**Request Body:**
```json
{
  "password": "userPassword123"
}
```

**Response:** `200 OK`
```json
{
  "message": "Account deleted successfully"
}
```

**Errors:**
- `400` - Missing fields (password, refresh token, or user ID)
- `401` - Invalid password
- `404` - User not found

**Note:**
- Requires password confirmation for safety
- Personal data is anonymized (email, phone, name ‚Üí NULL, is_deleted ‚Üí true)
- Session data (user_agent, client_ip, device_name) is cleared
- Company data is marked as deleted if user is owner
- Business records retained for 7 years (Austrian tax law)

---

#### PUT `/account/me`
Update user profile

**Headers:**
```
Authorization: Bearer <access_token>
```

**Request Body:**
```json
{
  "first_name": "Jane",
  "last_name": "Smith",
  "email": "newemail@example.com"
}
```

**Response:** `200 OK`
```json
{
  "message": "Profile updated successfully",
  "user": {
    "user_id": "123",
    "first_name": "Jane",
    "last_name": "Smith",
    "email": "newemail@example.com"
  }
}
```

**Errors:**
- `400` - No data provided
- `404` - User not found
- `409` - Email already in use

---

### Ride Management Endpoints

#### POST `/ride`
Create a new ride

**Headers:**
```
Authorization: Bearer <access_token>
```

**Request Body:**
```json
{
  "user_id": 123,
  "start_address": "Graz, Austria",
  "start_time": "2025-01-07T10:00:00Z",
  "start_lat": 47.0707,
  "start_lng": 15.4395,
  "end_address": "Vienna, Austria",
  "end_time": "2025-01-07T12:30:00Z",
  "end_lat": 48.2082,
  "end_lng": 16.3738,
  "duration": "02:30:00",
  "distance": 200500,
  "ride_type": "taxifahrt",
  "whole_ride": [
    [47.0707, 15.4395],
    [47.5000, 15.8000],
    [48.2082, 16.3738]
  ]
}
```

**Response:** `201 Created`
```json
{
  "message": "Ride created successfully",
  "ride": {
    "ride_id": "123",
    "user_id": "123",
    "start_address": "Graz, Austria",
    "end_address": "Vienna, Austria",
    "distance": 200500,
    "duration": "02:30:00",
    "ride_type": "taxifahrt"
  }
}
```

**Errors:**
- `400` - Missing required fields
- `400` - Invalid user_id (NaN or <= 0)

---

#### GET `/ride/:id`
Get single ride details

**Headers:**
```
Authorization: Bearer <access_token>
```

**Response:** `200 OK`
```json
{
  "ride_id": "123",
  "user_id": "123",
  "start_address": "Graz, Austria",
  "start_time": "2025-01-07T10:00:00Z",
  "start_lat": 47.0707,
  "start_lng": 15.4395,
  "end_address": "Vienna, Austria",
  "end_time": "2025-01-07T12:30:00Z",
  "end_lat": 48.2082,
  "end_lng": 16.3738,
  "duration": "02:30:00",
  "distance": 200500,
  "ride_type": "taxifahrt",
  "whole_ride": [
    [47.0707, 15.4395],
    [47.5000, 15.8000],
    [48.2082, 16.3738]
  ]
}
```

---

#### GET `/all-rides`
Get all rides for authenticated user

**Headers:**
```
Authorization: Bearer <access_token>
```

**Query Parameters:**
- `page` (optional) - Page number for pagination
- `limit` (optional) - Results per page

**Response:** `200 OK`
```json
{
  "rides": [
    {
      "ride_id": "123",
      "user_id": "123",
      "start_address": "Graz, Austria",
      "end_address": "Vienna, Austria",
      "start_time": "2025-01-07T10:00:00Z",
      "end_time": "2025-01-07T12:30:00Z",
      "distance": 200500,
      "duration": "02:30:00",
      "ride_type": "taxifahrt"
    }
  ],
  "message": "Rides retrieved successfully"
}
```

---

### Invoice Endpoints

#### POST `/invoice`
Generate invoice PDF for a ride and upload to S3

**Headers:**
```
Authorization: Bearer <access_token>
```

**Request Body:**
```json
{
  "ride_id": "123",
  "amount_net": 136.36,
  "tax_rate": 0.1,
  "amount_tax": 13.64,
  "amount_gross": 150.00,
  "tip_amount": 5.00,
  "payment_method": "card"
}
```

**Response:** `200 OK`
```json
{
  "message": "Invoice created successfully",
  "files": {
    "key": "invoices/user-123/invoice-456.pdf",
    "url": "https://storage.railway.app/bucket/invoice-456.pdf",
    "size": 45678,
    "lastModified": "2025-01-07T12:00:00Z",
    "billingData": {
      "billing_id": "456",
      "amount_net": "136.36",
      "amount_tax": "13.64",
      "amount_gross": "150.00",
      "tax_rate": "0.10",
      "tip_amount": "5.00",
      "payment_method": "card"
    },
    "driverData": {
      "name": "John Doe",
      "email": "john@example.com",
      "phonenumber": "+43123456789"
    }
  }
}
```

**Errors:**
- `400` - No File for the invoice provided (PDF generation failed)
- `409` - Invoice already exists for this ride
- `500` - Railway Bucket Error (S3 upload failed)

---

#### GET `/list-blobs`
List all stored invoices/files

**Headers:**
```
Authorization: Bearer <access_token>
```

**Response:** `200 OK`
```json
{
  "files": [
    {
      "key": "invoice-123.pdf",
      "url": "https://storage.railway.app/bucket/invoice-123.pdf",
      "size": 45678,
      "lastModified": "2025-01-07T12:00:00Z"
    }
  ]
}
```

---

### Dashboard Analytics Endpoints

#### GET `/rides/daily`
Get daily ride statistics for authenticated user

**Headers:**
```
Authorization: Bearer <access_token>
```

**Response:** `200 OK`
```json
{
  "daily": [
    {
      "date": "2025-01-07",
      "total_rides": 15,
      "total_distance": 450.5,
      "total_revenue": 750.00
    }
  ]
}
```

---

#### GET `/rides/weekly`
Get weekly ride statistics for authenticated user

**Headers:**
```
Authorization: Bearer <access_token>
```

**Response:** `200 OK`
```json
{
  "weekly": [
    {
      "week": "2025-W01",
      "total_rides": 85,
      "total_distance": 2500.0,
      "total_revenue": 4200.00
    }
  ]
}
```

---

#### GET `/rides/monthly`
Get monthly ride statistics for authenticated user

**Headers:**
```
Authorization: Bearer <access_token>
```

**Response:** `200 OK`
```json
{
  "monthly": [
    {
      "month": "2025-01",
      "total_rides": 350,
      "total_distance": 10500.0,
      "total_revenue": 17500.00
    }
  ]
}
```

---

## Team

#### Casper Zielinski (Fullstack Developer)

[<img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/github/github-original.svg" width="24" style="margin: 0 0.5em; transform: translate(0, 7px)"/>](https://github.com/casper-zielinski) [GitHub-Profil](https://github.com/casper-zielinski) <span style="margin: 0 0.5rem;"></span><br>
[<img src="https://static.thenounproject.com/png/286716-200.png" width="24" style="margin: 0 0.5rem; transform: translate(0, 7px)">](https://casperzielinski-portfolio.vercel.app/) [Portfolio](https://casperzielinski-portfolio.vercel.app/)

#### Mario Shenouda (Chief Executive Officer of Zynqly and Backend Developer)

[<img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/github/github-original.svg" width="24" style="margin: 0 0.5em; transform: translate(0, 7px)"/>](https://github.com/Juma2016) [GitHub-Profil](https://github.com/Juma2016) <span style="margin: 0 0.5rem;"></span><br>
[<img src="https://static.thenounproject.com/png/286716-200.png" width="24" style="margin: 0 0.5rem; transform: translate(0, 7px)">](https://mario-shenouda.com/) [Portfolio](https://mario-shenouda.com/)

#### Markus Rossmann (Backend Developer, DevOps Engineer and Scrum Master)

[<img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/github/github-original.svg" width="24" style="margin: 0 0.5em; transform: translate(0, 7px)"/>](https://github.com/Th3Stubi) [GitHub-Profil](https://github.com/Th3Stubi) <span style="margin: 0 0.5rem;"></span><br>
[<img src="https://static.thenounproject.com/png/286716-200.png" width="24" style="margin: 0 0.5rem; transform: translate(0, 7px)">](https://casperzielinski-portfolio.vercel.app/) [Portfolio](https://casperzielinski-portfolio.vercel.app/)

#### ‚Å†Umejr D≈æinoviƒá (Frontend Developer and Designer)

[<img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/github/github-original.svg" width="24" style="margin: 0 0.5em; transform: translate(0, 7px)"/>](https://github.com/Umex10) [GitHub-Profil](https://github.com/Umex10) <span style="margin: 0 0.5rem;"></span><br>
[<img src="https://static.thenounproject.com/png/286716-200.png" width="24" style="margin: 0 0.5rem; transform: translate(0, 7px)">](https://dev-resume-sigma.vercel.app/) [Portfolio](https://dev-resume-sigma.vercel.app/)

## Further Information

This project is part of an internal internship program at [FH Joanneum](https://www.fh-joanneum.at/en/).

## Licence

[MIT License](./LICENSE) 

---


![Made with Love](https://img.shields.io/badge/Made%20with-‚ù§Ô∏è-red?style=for-the-badge)
![Coffee](https://img.shields.io/badge/Powered%20by-Coffee-brown?style=for-the-badge&logo=buy-me-a-coffee)<br>
![Architecture](https://img.shields.io/badge/It%20works%20on%20my%20Machine-Architecture-2C3E50?labelColor=000000&logo=docker&logoColor=00D4FF)